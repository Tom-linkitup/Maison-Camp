package com.roomtype.model;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;

import javax.naming.Context;
import javax.naming.NamingException;
import javax.sql.DataSource;

public class RoomTypeDAO implements RoomTypeDAO_Interface{
	//連線池
		private static DataSource ds = null;
		static {
			try {
				Context ctx = new javax.naming.InitialContext();
				ds = (DataSource) ctx.lookup("java:comp/env/jdbc/GDB");
			} catch (NamingException e) {
				e.printStackTrace();
			}
		}
		
		private static final String Add_Stmt = "INSERT INTO ROOM_CATEGORY (ROOM_CATEGORY_ID, ROOM_NAME, ROOM_TYPE, ROOM_PRICE, AREA, ROOM_GUEST, ROOM_QUANTITY, ROOM_CATEGORY_STATUS, ROOM_INFO)" 
				+ "VALUES(?,?,?,?,?,?,?,?,?)";
		private static final String Update_Stmt = "UPDATE ROOM_CATEGORY SET ROOM_NAME=?, ROOM_TYPE=?, ROOM_PRICE=?, AREA=?, ROOM_GUEST=?, ROOM_QUANTITY=?, ROOM_CATEGORY_STATUS=?, ROOM_INFO=? WHERE ROOM_CATEGORY_ID=?";
		private static final String Delete_Stmt = "DELETE FROM ROOM_CATEGORY WHERE ROOM_CATEGORY_ID=?";
		private static final String Get_All_Stmt = "SELECT ROOM_CATEGORY_ID, ROOM_NAME, ROOM_TYPE, ROOM_PRICE, AREA, ROOM_GUEST, ROOM_QUANTITY, ROOM_CATEGORY_STATUS, ROOM_INFO FROM ROOM_CATEGORY ORDER BY ROOM_CATEGORY_ID";
		private static final String Get_One_Stmt = "SELECT ROOM_CATEGORY_ID, ROOM_NAME, ROOM_TYPE, ROOM_PRICE, AREA, ROOM_GUEST, ROOM_QUANTITY, ROOM_CATEGORY_STATUS, ROOM_INFO FROM ROOM_CATEGORY WHERE ROOM_CATEGORY_ID=?";
		
		
		@Override
		public void addRoomType(RoomTypeVO roomTypeVO) {
			Connection con = null;
			PreparedStatement pstmt = null;
			try {
				con = ds.getConnection();
				pstmt = con.prepareStatement(Add_Stmt);
				
				pstmt.setString(1, roomTypeVO.getRoom_category_id());
				pstmt.setString(2, roomTypeVO.getRoom_name());
				pstmt.setString(3, roomTypeVO.getRoom_type());
				pstmt.setInt(4, roomTypeVO.getRoom_price());
				pstmt.setInt(5, roomTypeVO.getArea());
				pstmt.setInt(6, roomTypeVO.getRoom_guest());
				pstmt.setInt(7, roomTypeVO.getRoom_quantity());
				pstmt.setInt(8, roomTypeVO.getRoom_category_status());
				pstmt.setString(9, roomTypeVO.getRoom_info());
				
				int roomAdd = pstmt.executeUpdate();
				System.out.println("新增"+ roomAdd + "筆房型資料");
				
			} catch (SQLException se) {
				throw new RuntimeException("A database error occured. "
						+ se.getMessage());
				// Clean up JDBC resources
			} finally {
				if (pstmt != null) {
					try {
						pstmt.close();
					} catch (SQLException se) {
						se.printStackTrace(System.err);
					}
				}
				if (con != null) {
					try {
						con.close();
					} catch (Exception e) {
						e.printStackTrace(System.err);
					}
				}
			}	
		}


		@Override
		public void updateRoomType(RoomTypeVO roomTypeVO) {
			// TODO Auto-generated method stub
			
		}


		@Override
		public void deleteRoomType(String room_category_id) {
			// TODO Auto-generated method stub
			
		}


		@Override
		public RoomTypeVO findByRoomCategoryId(String room_category_id) {
			// TODO Auto-generated method stub
			return null;
		}


		@Override
		public List<RoomTypeVO> getAllRoomType() {
			// TODO Auto-generated method stub
			return null;
		}
		
		
}
